<!DOCTYPE html>
<html lang="en">
<head>
  <!--
    Space Video -> Quiz -> Game Placeholder (single file)
    Customize:
      - Video: change VIDEO_SRC below (e.g., "sample.mp4" local file).
      - Questions: edit the `questions` array (text/options/correct).
      - Colors/UI: tweak CSS variables in :root.
    Supports mouse, touch, keyboard (tab/enter; number keys 1–4 while a question’s option is focused).
  -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Space Quiz & Play</title>
  <style>
    :root {
      --bg: radial-gradient(circle at 20% 20%, #1f2a63, #0d0f2f 60%);
      --panel: rgba(255, 255, 255, 0.08);
      --card: #1b214f;
      --text: #eef5ff;
      --accent: #7ce7ff;
      --good: #7cf5b3;
      --warn: #ffd36e;
      --button: linear-gradient(120deg, #5ecbff, #7b6dff);
      --button-2: linear-gradient(120deg, #ffb347, #ff7b7b);
      --star: rgba(255,255,255,0.5);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Segoe UI", system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }
    h1, h2 { margin: 0 0 10px; text-align: center; }
    button {
      cursor: pointer;
      border: none;
      border-radius: 14px;
      padding: 14px 18px;
      font-size: 18px;
      font-weight: 700;
      color: #fff;
      background: var(--button);
      box-shadow: 0 8px 18px rgba(0,0,0,0.25);
      transition: transform 0.1s ease, box-shadow 0.2s ease;
      touch-action: manipulation;
      min-height: 48px;
    }
    button:hover { transform: translateY(-1px); box-shadow: 0 10px 22px rgba(0,0,0,0.28); }
    button:active { transform: translateY(1px); }
    .secondary { background: var(--button-2); }
    .ghost { background: transparent; border: 2px solid var(--accent); color: var(--accent); }
    .layout { max-width: 960px; margin: 0 auto; padding: 18px; position: relative; z-index: 1; }
    .card {
      background: var(--panel);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.3);
      backdrop-filter: blur(6px);
    }
    .hidden { display: none; }
    .controls-inline { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; margin-top: 12px; }
    video {
      width: 100%; max-width: 900px; border-radius: 16px;
      border: 3px solid rgba(255,255,255,0.12);
      box-shadow: 0 12px 28px rgba(0,0,0,0.35);
      background: #000;
    }
    /* Modal */
    .modal-backdrop {
      position: fixed; inset: 0; background: rgba(5, 7, 22, 0.78);
      display: grid; place-items: center; z-index: 5;
      opacity: 0; pointer-events: none; transition: opacity 0.25s ease;
    }
    .modal-backdrop.show { opacity: 1; pointer-events: auto; }
    .modal {
      background: #1b1f46; color: #fff; border-radius: 18px;
      padding: 22px; width: min(420px, 90%);
      transform: scale(0.9); transition: transform 0.25s ease;
      box-shadow: 0 12px 30px rgba(0,0,0,0.35); position: relative;
    }
    .modal.show { transform: scale(1); }
    .close-btn {
      position: absolute; top: 10px; right: 10px;
      background: transparent; border: none; color: #fff;
      font-size: 20px; cursor: pointer;
    }
    /* Quiz */
    .quiz { display: grid; gap: 14px; }
    .question {
      padding: 12px; background: var(--card);
      border-radius: 14px; border: 1px solid rgba(255,255,255,0.08);
    }
    .question h3 { margin: 0 0 8px; font-size: 18px; }
    .options { display: grid; gap: 10px; }
    .option {
      display: flex; align-items: center; gap: 12px;
      background: rgba(255,255,255,0.05);
      padding: 10px 12px; border-radius: 12px;
      border: 2px solid transparent; min-height: 48px;
    }
    .option.unanswered { border-color: var(--warn); }
    .option input {
      width: 24px; height: 24px; accent-color: var(--accent); cursor: pointer;
    }
    .inline-warn { color: var(--warn); font-weight: 700; text-align: center; min-height: 24px; }
    /* Placeholder Game */
    .placeholder {
      display: grid; gap: 14px; justify-items: center;
      padding: 20px; background: var(--card);
      border-radius: 16px; border: 1px solid rgba(255,255,255,0.08);
    }
    /* Starfield */
    .starfield {
      position: fixed; inset: 0; pointer-events: none;
      background-image:
        radial-gradient(1px 1px at 20% 30%, var(--star), transparent),
        radial-gradient(1.5px 1.5px at 70% 20%, var(--star), transparent),
        radial-gradient(1px 1px at 40% 80%, var(--star), transparent),
        radial-gradient(1.5px 1.5px at 80% 70%, var(--star), transparent);
      opacity: 0.5; animation: twinkle 8s linear infinite; z-index: 0;
    }
    @keyframes twinkle { 0%,100% { opacity: 0.45; } 50% { opacity: 0.65; } }
    .aria-live { position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden; }
  </style>
</head>
<body>
  <div class="starfield"></div>
  <div class="layout">
    <h1>Space Adventure: Watch, Quiz, Play!</h1>

    <!-- Video Section -->
    <section id="videoSection" class="card">
      <h2>1) Watch the Space Video</h2>
      <video id="lessonVideo" controls preload="auto" aria-label="Space lesson video">
        <!-- Replace VIDEO_SRC in JS to change the video source -->
        <source id="videoSource" src="" type="video/mp4">
        Your browser does not support video.
      </video>
      <div class="controls-inline">
        <button id="playPauseBtn">Play / Pause</button>
        <button id="replayBtn" class="secondary">Replay</button>
      </div>
      <p class="center" style="margin:8px 0 0;">Quiz unlocks after the video ends.</p>
    </section>

    <!-- Quiz Section -->
    <section id="quizSection" class="card hidden">
      <h2>2) Quick Space Quiz</h2>
      <div id="quizContainer" class="quiz"></div>
      <div class="inline-warn" id="quizWarn"></div>
      <div class="controls-inline">
        <button id="submitQuizBtn">Submit Answers</button>
        <button id="restartQuizBtn" class="ghost">Restart Quiz</button>
      </div>
    </section>

    <!-- Game Placeholder Section -->
    <section id="gameSection" class="card hidden">
      <div class="placeholder">
        <h2>Game Coming Soon!</h2>
        <p style="font-size:18px;">Thanks for playing. Stay tuned!</p>
        <div class="controls-inline">
          <button id="backToStartBtn" class="ghost">Replay Video</button>
        </div>
      </div>
    </section>
  </div>

  <!-- Unlock Quiz Modal -->
  <div class="modal-backdrop" id="quizUnlockBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-labelledby="unlockTitle" aria-modal="true">
      <button class="close-btn" aria-label="Close" id="closeUnlock">✕</button>
      <h2 id="unlockTitle">Great! Ready for a short quiz?</h2>
      <p>Click start to try 5 quick questions.</p>
      <div class="controls-inline">
        <button id="startQuizBtn">Start Quiz</button>
      </div>
    </div>
  </div>

  <!-- Results Modal -->
  <div class="modal-backdrop" id="resultsBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-labelledby="resultsTitle" aria-modal="true">
      <button class="close-btn" aria-label="Close" id="closeResults">✕</button>
      <h2 id="resultsTitle">Your score</h2>
      <p id="resultsText"></p>
      <div class="controls-inline">
        <button id="playGameBtn">Play the Game</button>
      </div>
    </div>
  </div>

  <div class="aria-live" aria-live="polite" id="liveRegion"></div>

  <script>
    // ------------------ Configurable content ------------------
    const VIDEO_SRC = "sample.mp4"; // Replace with your video file (local or URL)
    const questions = [
      {
        text: "Q1: Who is the leader of the Solar System in the story?",
        options: [
          "A) Jupiter",
          "B) Earth",
          "C) Sunny the Sun",
          "D) Mars"
        ],
        correct: 2
      },
      {
        text: "Q2: Which planet is the closest to the Sun?",
        options: [
          "A) Neptune",
          "B) Mercury",
          "C) Venus",
          "D) Uranus"
        ],
        correct: 1
      },
      {
        text: "Q3: Which planet has thick clouds that trap heat?",
        options: [
          "A) Saturn",
          "B) Venus",
          "C) Mars",
          "D) Earth"
        ],
        correct: 1
      },
      {
        text: "Q4: Which planet has a giant storm called the Great Red Spot?",
        options: [
          "A) Jupiter",
          "B) Pluto",
          "C) Earth",
          "D) Neptune"
        ],
        correct: 0
      },
      {
        text: "Q5: What does the Moon do in the story?",
        options: [
          "A) Lights up the Sun",
          "B) Orbits around Mars",
          "C) Goes around Earth and lights up the night",
          "D) Spins around Jupiter"
        ],
        correct: 2
      }
    ];

    // ------------------ DOM refs ------------------
    const videoEl = document.getElementById("lessonVideo");
    const videoSource = document.getElementById("videoSource");
    const playPauseBtn = document.getElementById("playPauseBtn");
    const replayBtn = document.getElementById("replayBtn");
    const videoSection = document.getElementById("videoSection");
    const quizSection = document.getElementById("quizSection");
    const gameSection = document.getElementById("gameSection");
    const quizContainer = document.getElementById("quizContainer");
    const submitQuizBtn = document.getElementById("submitQuizBtn");
    const restartQuizBtn = document.getElementById("restartQuizBtn");
    const quizWarn = document.getElementById("quizWarn");
    const quizUnlockBackdrop = document.getElementById("quizUnlockBackdrop");
    const startQuizBtn = document.getElementById("startQuizBtn");
    const closeUnlock = document.getElementById("closeUnlock");
    const resultsBackdrop = document.getElementById("resultsBackdrop");
    const resultsText = document.getElementById("resultsText");
    const closeResults = document.getElementById("closeResults");
    const playGameBtn = document.getElementById("playGameBtn");
    const backToStartBtn = document.getElementById("backToStartBtn");
    const liveRegion = document.getElementById("liveRegion");

    // ------------------ Audio helpers ------------------
    const AudioFX = (() => {
      let ctx;
      const safeCtx = () => {
        try { ctx = ctx || new (window.AudioContext || window.webkitAudioContext)(); return ctx; }
        catch { return null; }
      };
      function tone(freq, dur = 0.2, vol = 0.1) {
        const c = safeCtx(); if (!c) return;
        const osc = c.createOscillator();
        const gain = c.createGain();
        osc.type = "sine";
        osc.frequency.value = freq;
        gain.gain.value = vol;
        osc.connect(gain).connect(c.destination);
        const now = c.currentTime;
        osc.start(now);
        osc.stop(now + dur);
      }
      return {
        success() { tone(800, 0.25, 0.12); tone(1000, 0.25, 0.08); },
        gentle() { tone(400, 0.3, 0.08); }
      };
    })();

    // ------------------ Modal helpers ------------------
    function showModal(backdrop) {
      backdrop.classList.add("show");
      backdrop.querySelector(".modal").classList.add("show");
      backdrop.setAttribute("aria-hidden", "false");
    }
    function hideModal(backdrop) {
      backdrop.classList.remove("show");
      backdrop.querySelector(".modal").classList.remove("show");
      backdrop.setAttribute("aria-hidden", "true");
    }

    // ------------------ Video logic ------------------
    function initVideo() {
      videoSource.src = "meet_planets.mp4";
      videoEl.load();
      playPauseBtn.addEventListener("click", () => {
        if (videoEl.paused) videoEl.play(); else videoEl.pause();
      });
      replayBtn.addEventListener("click", replayVideo);
      videoEl.addEventListener("ended", showStartQuizModal);
    }
    function replayVideo() {
      hideModal(quizUnlockBackdrop);
      hideModal(resultsBackdrop);
      gameSection.classList.add("hidden");
      quizSection.classList.add("hidden");
      videoSection.classList.remove("hidden");
      videoEl.currentTime = 0;
      videoEl.play();
      setLive("Replaying video");
    }
    function showStartQuizModal() { showModal(quizUnlockBackdrop); }

    // ------------------ Quiz logic ------------------
    function renderQuiz() {
      quizContainer.innerHTML = "";
      questions.forEach((q, qi) => {
        const wrap = document.createElement("div");
        wrap.className = "question";
        wrap.innerHTML = `<h3>${q.text}</h3>`;
        const opts = document.createElement("div");
        opts.className = "options";
        q.options.forEach((opt, oi) => {
          const id = `q${qi}_opt${oi}`;
          const label = document.createElement("label");
          label.className = "option";
          label.setAttribute("for", id);
          label.innerHTML = `
            <input type="radio" id="${id}" name="q${qi}" value="${oi}">
            <span>${opt}</span>
          `;
          opts.appendChild(label);
        });
        wrap.appendChild(opts);
        quizContainer.appendChild(wrap);
      });
    }

    function startQuiz() {
      hideModal(quizUnlockBackdrop);
      videoSection.classList.add("hidden");
      gameSection.classList.add("hidden");
      quizSection.classList.remove("hidden");
      quizWarn.textContent = "";
      renderQuiz();
      const first = quizContainer.querySelector("input[type=radio]");
      if (first) first.focus();
      setLive("Quiz started");
    }

    function validateQuiz() {
      let allAnswered = true;
      quizWarn.textContent = "";
      document.querySelectorAll(".option").forEach(o => o.classList.remove("unanswered"));
      questions.forEach((_, qi) => {
        const selected = document.querySelector(`input[name="q${qi}"]:checked`);
        if (!selected) {
          allAnswered = false;
          document.querySelectorAll(`input[name="q${qi}"]`).forEach(inp => {
            inp.parentElement.classList.add("unanswered");
          });
        }
      });
      if (!allAnswered) quizWarn.textContent = "Please answer all questions!";
      return allAnswered;
    }

    function calculateScore() {
      let score = 0;
      questions.forEach((q, qi) => {
        const selected = document.querySelector(`input[name="q${qi}"]:checked`);
        if (selected && Number(selected.value) === q.correct) score++;
      });
      return score;
    }

    function showResults(score) {
      resultsText.textContent = `You scored ${score} out of 5!`;
      showModal(resultsBackdrop);
      if (score >= 3) AudioFX.success(); else AudioFX.gentle();
      setLive(`Score ${score} of 5`);
    }

    function showGamePlaceholder() {
      hideModal(resultsBackdrop);
      quizSection.classList.add("hidden");
      videoSection.classList.add("hidden");
      gameSection.classList.remove("hidden");
      setLive("Game placeholder shown");
    }

    // ------------------ Utilities ------------------
    function setLive(text) { liveRegion.textContent = text; }

    // Keyboard shortcut: number keys 1–4 for the focused question’s options
    document.addEventListener("keydown", e => {
      const keyNum = Number(e.key);
      if (keyNum >= 1 && keyNum <= 4) {
        const active = document.activeElement;
        const groupName = active && active.name ? active.name : null;
        if (groupName && groupName.startsWith("q")) {
          const target = document.querySelector(`input[name="${groupName}"][value="${keyNum - 1}"]`);
          if (target) target.checked = true;
        }
      }
    });

    // ------------------ Wiring ------------------
    function init() {
      initVideo();
      renderQuiz(); // prebuild for restart ease

      startQuizBtn.addEventListener("click", startQuiz);
      closeUnlock.addEventListener("click", () => hideModal(quizUnlockBackdrop));

      submitQuizBtn.addEventListener("click", () => {
        if (!validateQuiz()) return;
        const score = calculateScore();
        showResults(score);
      });
      restartQuizBtn.addEventListener("click", startQuiz);

      closeResults.addEventListener("click", () => hideModal(resultsBackdrop));
      playGameBtn.addEventListener("click", showGamePlaceholder);
      backToStartBtn.addEventListener("click", replayVideo);
    }

    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>

